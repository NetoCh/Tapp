<div class="page-holder w-100 d-flex flex-wrap mt-5">
  <div class="container-fluid px-xl-5">
    <!--Buscador-->
    <section>
      <div class="col-lg-12 mb-5">
        <div class="card px-2 py-1">
          <div class="card-body px-1 py-2">
              <div class="row">
                <div class="col-lg-2 text-center">
                  <button type="button" data-toggle="modal" data-target="#myModal" class="btn btn-primary">Filtrar
                    vacantes</button>
                </div>
                <div class="form-group position-relative mb-0 col-lg-7 mt-1 ml-lg-3 ">
                  <button type="submit" style="top: -3px; left: 0;"
                    class="position-absolute bg-white border-0 p-0 ml-4"><i
                      class="o-search-magnify-1 text-gray text-lg"></i></button>
                  <input type="search" placeholder="Buscar vacantes..."
                    class="form-control form-control-sm border-0 no-shadow pl-4 ml-2" id="buscar" value="">
                </div>
              </div>
            <!-- Modal para filtrar-->
            <div id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"
              class="modal fade text-left">
              <div role="document" class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h4 id="exampleModalLabel" class="modal-title">Filtrar vacantes</h4>
                    <button type="button" data-dismiss="modal" aria-label="Close" class="close"><span aria-hidden="true">×</span></button>
                  </div>
                  <form class="range-field" action="/filtrarVacantes" method="POST">
                    <div class="modal-body">
                      <div class="form-group">
                        <label class="col-lg-4">Empresa</label>
                        <div class="custom-control-inline ml-2 ">
                          <select class="form-control" name="empresa">
                            <option selected value="0">Todas</option>
                            <% for (var data of page.empresas) { %>
                            <option value=<%= data.id_empresa %>><%= data.nombre_empresa %></option>
                            <% } %>
                          </select>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-lg-4">Area laboral</label>
                        <div class="custom-control-inline ml-2 ">
                          <select class="form-control" name="area">
                            <option selected value="0">Todas</option>
                            <% for (var data of page.areas) { %>
                            <option value=<%= data.id_area %>><%= data.nombre %></option>
                            <% } %>
                          </select>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-lg-4">Destacado</label>
                        <div class="custom-control custom-radio custom-control-inline ml-2 col-1">
                          <input id="destacado_si" type="radio" name="destacado" class="custom-control-input" value="1">
                          <label for="destacado_si" class="custom-control-label">Sí</label>
                        </div>
                        <div class="custom-control custom-radio custom-control-inline ml-2 col-1">
                          <input id="destacado_no" type="radio" name="destacado" class="custom-control-input" value="0">
                          <label for="destacado_no" class="custom-control-label">No</label>
                        </div>
                        <div class="custom-control custom-radio custom-control-inline ml-2 col-1">
                          <input id="destacado_cualquiera" type="radio" name="destacado" class="custom-control-input"
                            value="2" checked>
                          <label for="destacado_cualquiera" class="custom-control-label">Todos</label>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-lg-4">Salario minimo:</label>
                        <div class="custom-control-inline ml-2">
                          <input class="form-control" type="number" min="200" step="10" name="salario_min">
                        </div>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button type="submit" class="btn btn-primary">Buscar</button>
                      <button type="button" data-dismiss="modal" class="btn btn-secondary">Cerrar</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!--Vacantes-->
    <section>
      <div class="row text-dark px-5">
        <% if (page.vacantes.length == 0){ %>
            <div class="p-3 col-12">
              <h2 class="text-center"><small>No hay resultados con esos requerimientos. Inténtelo con otros.</small></h2>
            </div>
        <%} else {%>
        <% var i = -1; for(var data of page.vacantes) { i++ %>
        <div class="col-lg-4 mb-4" id="<%= i %>"><a href="#" class="message bg-hover-gradient-primary no-anchor-style" data-toggle="modal" data-target="#modal" data-id=<%= i %>>
            <div class="card rounded bg-hover-gradient-blue">
              <div class="content p-4">
                <div class="d-flex align-items-start flex-column">
                  <div class="row">
                    <div class="p-3" style="height: 100px;">
                      <h2><% if(data.destacado == 1) { %><img src="/img/medalla-de-honor.svg" class="float-left"
                          style="max-width: 40px;" alt=""> <% } else { %> <i class="fas fa-bullhorn"></i><% } %><small
                          class="ml-3"><%- data.nombre_empresa %></small></h2>
                    </div>
                  </div>
                  <div class="row">
                    <div class="pl-3 mt-3 col-lg-12">
                      <small class="text-gray" style="overflow-x:-webkit-marquee;"><%- data.email %></small>
                      <!-- <marquee behavior="scroll" direction="right"
                        onmouseout="this.stop();">Hower over and hold the mouse marquee stop</marquee> -->
                    </div>
                  </div>
                  <div class="row">
                    <div class="p-3 text-uppercase font-weight-bold " style="height: 100px;">
                      <h4><%- data.nombre_vacante %></h4>
                    </div>
                  </div>
                  <div class="row">
                    <div class="p-3">
                      <h5>$<%- data.salario %></h5>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </a>
        </div>
        <% } } %>
        <!-- Modal2 (dettalles de vacante)-->
        <div id="modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
          aria-hidden="true" class="modal fade text-left">
          <div role="document" class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h4 id="exampleModalLabel" class="modal-title">Detalles de la vacante</h4>
                <button type="button" data-dismiss="modal" aria-label="Close" class="close"><span
                    aria-hidden="true">×</span></button>
              </div>
              <div class="modal-body">
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Nombre: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#nombre"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Descripción de la vacante: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#descripcion"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Área laboral: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#area"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Requisitos </strong>
                  </div>
                  <div class="col-8">
                    <p id="#requisito"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Trabajos a desempeñar: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#trabajos"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Salario: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#salario"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Ubicación del trabajo: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#ubicacion"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Tipo de horario: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#horario"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Fecha de publicación: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#fecha"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Nombre de la empresa: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#empresa"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Descripción de la empresa: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#descripcionempr"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Teléfono de la empresa: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#telefono"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Sitio web: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#sitio"></p>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-4">
                    <strong>Email: </strong>
                  </div>
                  <div class="col-8">
                    <p id="#email"></p>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-secondary">Cerrar</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
  <footer class="footer bg-white shadow align-self-end py-3 px-xl-5 w-100">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-6 text-center text-md-left text-primary">
          <p class="mb-2 mb-md-0">Tapp</p>
        </div>
        <div class="col-md-6 text-center text-md-right text-gray-400">
          <p class="mb-0">Proyecto de Desarrollo IX</p>
          <!-- Please do not remove the backlink to us unless you support further theme's development at https://bootstrapious.com/donate. It is part of the license conditions. Thank you for understanding :)-->
        </div>
      </div>
    </div>
  </footer>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script>
    var buscar = document.querySelector('#buscar');
    var data = '<%-JSON.stringify(page.vacantes)%>';
    var objVacantes = JSON.parse(data);
    console.log(objVacantes);
    var comparar = new Array();
    var filtrar = () =>{
      for (let data of objVacantes){
        comparar.push(data.nombre_empresa+" "+data.nombre_vacante);
      }
      for (let data of comparar){
          let z = comparar.findIndex(index => index === data);
          let m = document.getElementById(z);
          if(data.toLowerCase().indexOf(buscar.value.toLowerCase()) !== -1){
            if (m.style.display === "none"){
                m.style.display = "block";
            }
          }
          else{
            m.style.display = "none";
          }
      }
    }
    buscar.addEventListener('keyup', filtrar);
  </script>
  <script type="text/javascript">
    $(document).on("click", ".message", function () {
      document.getElementById("#nombre").innerHTML = objVacantes[$(this).data('id')].nombre_vacante;
      document.getElementById("#descripcion").innerHTML = objVacantes[$(this).data('id')].descripcion_vacante;
      document.getElementById("#area").innerHTML = objVacantes[$(this).data('id')].nombre_area;
      document.getElementById("#requisito").innerHTML = objVacantes[$(this).data('id')].requisitos;
      document.getElementById("#trabajos").innerHTML = objVacantes[$(this).data('id')].trabajos_desempeñar;
      document.getElementById("#salario").innerHTML = "$"+objVacantes[$(this).data('id')].salario;
      document.getElementById("#ubicacion").innerHTML = objVacantes[$(this).data('id')].ubicacion;
      document.getElementById("#horario").innerHTML = objVacantes[$(this).data('id')].tipo_horario;
      document.getElementById("#fecha").innerHTML = objVacantes[$(this).data('id')].fecha;
      document.getElementById("#empresa").innerHTML = objVacantes[$(this).data('id')].nombre_empresa; 
      document.getElementById("#descripcionempr").innerHTML = objVacantes[$(this).data('id')].descripcion_empresa;  
      document.getElementById("#telefono").innerHTML = objVacantes[$(this).data('id')].telefono_empresa; 
      document.getElementById("#sitio").innerHTML = objVacantes[$(this).data('id')].pagina_web;  
      document.getElementById("#email").innerHTML = objVacantes[$(this).data('id')].email;
    });
  </script>
</div>

<!-- <div class="col-lg-4 mb-4"><a href="#" class="bg-hover-gradient-primary no-anchor-style" data-toggle="modal"
            data-target="#myModal2">
            <div class="card rounded bg-hover-gradient-violet">
              <div class="content p-4">
                <h2 class="mb-5"><i class="fas fa-bullhorn"></i><small class="ml-3">iThink</small></h2>
                <small class="text-gray">iThink@yahoo.com</small>
                <div class="text-uppercase">
                  <div class="font-weight-bold d-block">Diseñador grafico</div>
                  <h4 class="mb-0">$780.00</h4>
                </div>
              </div>
            </div>
          </a>
      </div> -->